<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebSocket with Flask-SocketIO</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.0/socket.io.min.js"></script>
</head>
<body>
    <h1>WebSocket with Flask</h1>
    <button onclick="sendMessage()">Send Message</button>

    <script type="text/javascript">
        const socket = io.connect(window.location.origin);

        socket.on('connect', function() {
            console.log('Connected to the server');
        });

        socket.on('message', function(message) {
            console.log('Received message from server:', message);
        });

        socket.on('response_event', function(data) {
            console.log('Received custom event response:', data);
        });

        function sendMessage() {
            socket.send("Hello, Server!");
        }

        // Emitting a custom event
        function sendCustomEvent() {
            socket.emit('custom_event', { data: "Hello from custom event" });
        }
    </script>









<script>
    // List to keep track of players (from the server)
    let players = [];

    // Function to submit the form using AJAX
    function submitForm(event) {
        event.preventDefault(); // Prevent form from reloading the page

        const character = document.getElementById('character').value; // Get the selected character

        // Check if the character is already taken
        if (players.some(player => player.character === character)) {
            document.getElementById('response').innerText = `The character "${character}" is already taken. Please choose a different one.`;
            return;
        }

        const data = {
            character: character,
        };

        // Send the request to the Flask server to add the player
        fetch('/add_player', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
            // Display the response message
            document.getElementById('response').innerText = data.message || 'Player added successfully!';

            // Update the list of players
            players.push({ character: character, location: location });

            // Display updated players list
            displayPlayers();

            // Enable the "Start Game" button if there are 3 or more players
            if (players.length >= 3) {
                document.getElementById('startGameBtn').disabled = false;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('response').innerText = 'An error occurred!';
        });
    }

    // Function to display the list of players
    function displayPlayers() {
        const playerListContainer = document.getElementById('playerList');
        playerListContainer.innerHTML = ''; // Clear the current list

        // Display the total number of players
        const playerCount = document.createElement('h3');
        playerCount.textContent = `Players joined: ${players.length}`;
        playerListContainer.appendChild(playerCount);

        // List all players
        const playerList = document.createElement('ul');
        players.forEach(player => {
            const playerItem = document.createElement('li');
            playerItem.textContent = `${player.character} - ${player.location}`;
            playerList.appendChild(playerItem);
        });
        playerListContainer.appendChild(playerList);
    }

    // Function to start the game
    function startGame() {
        fetch('/start_game', {
            method: 'GET'
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('response').innerText = data.message || 'Game started!';
            document.getElementById('startGameBtn').disabled = true; // Disable the button once the game starts
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('response').innerText = 'An error occurred while starting the game.';
        });
    }
</script>
</head>
<body>
<div class="container">
    <h1>Welcome to the Clue Game!</h1>
    <h2>Choose Your Character</h2>

    <!-- Form to input the character's name and location -->
    <form id="characterForm" onsubmit="submitForm(event)">
        <div>
            <label for="character">Character:</label>
            <select id="character" name="character" required>
                <option value="">-- Select a Character --</option>
                <option value="Miss Scarlet">Miss Scarlet</option>
                <option value="Professor Plum">Professor Plum</option>
                <option value="Colonel Mustard">Colonel Mustard</option>
                <option value="Mrs. White">Mrs. White</option>
                <option value="Mr. Green">Mr. Green</option>
                <option value="Mrs. Peacock">Mrs. Peacock</option>
            </select>
        </div>
        <button type="submit">Join Game</button>
    </form>

    <!-- Response message -->
    <p id="response" style="margin-top: 20px; color: green;"></p>

    <!-- Display list of players who have joined -->
    <div id="playerList">
        <!-- The list will be dynamically populated here -->
    </div>

    <!-- Start Game button, initially disabled -->
    <button id="startGameBtn" onclick="startGame()" disabled>Start Game</button>
</div>






</div>
</body>
</body>
</html>
